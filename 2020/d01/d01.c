#include <stdio.h>

int nums[256] = {0};
char input[] = "1864\n1880\n1300\n1961\n1577\n1900\n1307\n1818\n1736\n1846\n"
"1417\n1372\n1351\n1860\n1738\n1525\n1798\n1218\n1723\n1936\n"
"1725\n1998\n1466\n1922\n1782\n1947\n1717\n1914\n1843\n1732\n"
"1918\n814\n1771\n1712\n1804\n1213\n1859\n1820\n1793\n1870\n1"
"993\n1787\n1824\n1849\n1646\n1489\n1348\n1978\n1628\n1781\n2"
"002\n1297\n1829\n1596\n1819\n1313\n1413\n1726\n1449\n1810\n1"
"295\n1679\n1358\n1949\n1644\n1825\n1891\n490\n1962\n1939\n12"
"28\n1889\n1977\n1980\n1763\n1752\n1983\n1785\n1678\n2000\n18"
"57\n1658\n1863\n1330\n1380\n1799\n1789\n1633\n1663\n296\n198"
"5\n1117\n1239\n1854\n1960\n2004\n1940\n1876\n1739\n1858\n128"
"3\n1423\n1982\n1836\n1451\n1840\n1347\n1652\n1695\n1210\n186"
"1\n1199\n1346\n1786\n1814\n1958\n1853\n1974\n1917\n1308\n654"
"\n1743\n1847\n1367\n1559\n1614\n1897\n2003\n1886\n1885\n1682"
"\n1204\n1986\n1816\n1994\n1817\n1751\n1701\n1619\n1970\n816"
"\n1852\n1832\n1631\n703\n1604\n1444\n1842\n1984\n1259\n1948\n"
"1620\n1681\n1822\n1865\n1521\n1741\n1455\n1909\n1764\n261\n1"
"464\n1905\n1325\n1766\n1749\n1292\n1874\n1267\n1269\n1969\n1"
"991\n1219\n1345\n1976\n1369\n1942\n1388\n1776\n1629\n1987\n1"
"684\n1813\n1203\n1965\n1729\n1930\n1609\n1801\n1402\n121\n18"
"33\n1898\n1957\n1051\n1430\n1893\n1784\n1800\n1910";

int main() {
    int nums_len = 0;
    int i = 0;
    int j = 0;
    int want;
    int want_i;
    int want_shift;
    char seen[256] = {0};
    char *inp = input;
    int p1 = 0;
    int p2 = 0;

    do {
        nums[i] = *inp++ - 0x30;
        while (*inp >= 0x30) {
            nums[i] = nums[i] * 10 + *inp++ - 0x30;
        }
        seen[nums[i]/8] |= 1 << (nums[i] % 8);
        want = 2020 - nums[i];
        want_i = want / 8;
        want_shift = want % 8;
        if ((seen[want_i] & (1 << want_shift)) > 0) {
            p1 = want * nums[i];
        }
        i++;
    } while (*inp++ != 0);
    nums_len = i;

    for (i = 0; i < nums_len; i++) {
        for (j = i + 1; j < nums_len; j++) {
            want = 2020 - (nums[i] + nums[j]);
            want_i = want / 8;
            want_shift = want % 8;
            if (want > 0 && (seen[want_i] & (1 << want_shift)) > 0) {
                p2 = want * nums[i] * nums[j];
                i = 256;
                j = 256;
            }
        }
    }

    printf("p1 = %i; p2 = %i\n", p1, p2);
    return 0;
}
